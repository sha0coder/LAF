== intro ==

LAF - Linux Application Firewall
This kernel driver blocks internet sockets, allowing only whitelisted process to connect to LAN and internet.

iptables filter by ip and port but not by process name, laf.ko is a simple driver for do this.


== configure == 

edit whitelist.h 

There are two whitelist, one is compared literally with the 
process name who is trying to create internet sockets.

The other whitelist is compared with strstr(), if you want allow all processnames whos name contains x word, then this is the wordlist for doing that.

For example chrome has process name with variable name, then this wordlist should be used.


== run ==

$ make install

This will compile and copy the module on /lib/modules.
You can load it with:

$ make load

If you want to see what is blocking the LAF driver:

tail -f /var/log/kern.log

[ 9006.541447] LAF: Enabled
[ 9010.042030] LAF: call 01 fam 0x100000002 blocked: iexplore.exe (24763:24730) parent: wine (24728)
[ 9015.586690] LAF: call 01 fam 0x100000002 blocked: kk.x86 (24769:24769) parent: bash (10343)
[13118.760088] LAF: call 01 fam 0x100000002 blocked: wineserver (25729:25729) parent: systemd (1)
[16569.004590] LAF: fam 10 proto 00 blocked: VBoxXPCOMIPCD (26102:26102) parent: systemd (1)
[16569.048654] LAF: fam 10 proto 00 blocked: VBoxSVC (26107:26107) parent: systemd (1)


== filosofy ==

This is not a protection agains advanced attackers, this can by bypassed for example changing the process name for a whitelisted one.

The objective is detecting and/or blocking software that should not be connecting to internet, as spyware.

In the past, we protected our open ports to internet, nowadays the problem is in client side, 
client apps sending data to internet.


== authors ==
@sha0coder && @capi_x

